<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Socioeconomic Status Scale (FSESS) Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Cairo:wght@400;700&display=swap');
        
        /* Default font for LTR */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        /* Override for RTL */
        [dir="rtl"] body, [dir="rtl"] .text-right-rtl {
            font-family: 'Cairo', sans-serif;
            text-align: right;
        }
        [dir="rtl"] .text-left-rtl {
            text-align: right;
        }
        [dir="ltr"] .text-left-rtl {
            text-align: left;
        }

        /* Fix LTR inputs in RTL view */
        [dir="rtl"] select, [dir="rtl"] input[type="radio"], [dir="rtl"] input[type="checkbox"] {
            margin-left: 0.75rem;
            margin-right: 0;
        }
        [dir="rtl"] .space-x-reverse > * {
            margin-right: 0.75rem !important;
            margin-left: 0 !important;
        }

    </style>
</head>
<body class="p-4 sm:p-8">
    
    <div id="app" class="max-w-4xl mx-auto bg-white shadow-xl rounded-xl p-6 sm:p-10 border border-gray-100">
        <h1 id="main-title" class="text-3xl sm:text-4xl font-extrabold text-blue-700 mb-6 text-left">
            FSESS Calculator
        </h1>

        <!-- ======================================= LANGUAGE SELECTION SCREEN ======================================= -->
        <div id="language-select-screen">
            <h2 class="text-2xl font-bold text-gray-700 mb-4 text-left">Choose Language | Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©</h2>
            <p class="text-gray-700 mb-8 text-left leading-loose">
                Please select your preferred language to continue. | Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù„ØºØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø© Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button onclick="setLanguage('en')" class="w-full sm:w-1/2 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md">
                    English (EN)
                </button>
                <button onclick="setLanguage('ar')" class="w-full sm:w-1/2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md">
                    Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (AR)
                </button>
            </div>
        </div>
        
        <!-- ======================================= 1. INTRO SCREEN ======================================= -->
        <div id="intro-screen" class="hidden">
            <h2 id="welcome-title" class="text-2xl font-bold text-gray-700 mb-4 text-left-rtl">Welcome to the FSESS Calculator</h2>
            <div id="welcome-text" class="text-gray-700 mb-8 leading-loose text-left-rtl text-sm space-y-3 border-b pb-6">
                <!-- Content generated by JS -->
            </div>
            
            <button onclick="startCalculation()" id="start-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md">
                Start Calculation
            </button>
        </div>

        <!-- ======================================= 2. CALCULATION SCREEN ======================================= -->
        <div id="calculator-screen" class="hidden">
            <div id="error-message" class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm hidden text-center mb-6">
                <!-- Error message inserted by JS -->
            </div>

            <form id="ses-form" class="space-y-8">
                <h2 id="calc-title" class="text-2xl font-bold text-gray-700 border-b pb-2 mb-4 text-left-rtl">1. Family Demographics</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Husband/Male Head -->
                    <div class="p-4 border rounded-lg bg-gray-50 space-y-4">
                        <h3 id="husband-title" class="text-lg font-semibold text-gray-700 text-left-rtl">A. Husband/Male Head of Household</h3>
                        <label id="edu-h-label" for="edu_h" class="block text-sm font-medium text-gray-700 text-left-rtl">Education Level</label>
                        <select id="edu_h" class="mt-1 block w-full pl-3 pr-10 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></select>
                        
                        <label id="occ-h-label" for="occ_h" class="block text-sm font-medium text-gray-700 text-left-rtl">Occupation Category</label>
                        <select id="occ_h" class="mt-1 block w-full pl-3 pr-10 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></select>
                    </div>

                    <!-- Wife/Female Head -->
                    <div class="p-4 border rounded-lg bg-gray-50 space-y-4">
                        <h3 id="wife-title" class="text-lg font-semibold text-gray-700 text-left-rtl">B. Wife/Female Head of Household</h3>
                        <label id="edu-w-label" for="edu_w" class="block text-sm font-medium text-gray-700 text-left-rtl">Education Level</label>
                        <select id="edu_w" class="mt-1 block w-full pl-3 pr-10 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></select>
                        
                        <label id="occ-w-label" for="occ_w" class="block text-sm font-medium text-gray-700 text-left-rtl">Occupation Category</label>
                        <select id="occ_w" class="mt-1 block w-full pl-3 pr-10 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></select>
                    </div>
                </div>

                <h2 id="finance-title" class="text-2xl font-bold text-gray-700 border-b pb-2 mb-4 text-left-rtl">2. Family Finances & Assets</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Family Income -->
                    <div class="p-4 border rounded-lg bg-gray-50 space-y-4">
                        <h3 id="income-title" class="text-lg font-semibold text-gray-700 text-left-rtl">C. Family Income (Max 3 points)</h3>
                        <div class="space-y-2" id="income-radio-group"></div>
                    </div>

                    <!-- Family Assets -->
                    <div class="p-4 border rounded-lg bg-gray-50 space-y-4">
                        <h3 id="assets-title" class="text-lg font-semibold text-gray-700 text-left-rtl">D. Family Assets & Possessions (Max 10 points)</h3>
                        <div class="grid grid-cols-2 gap-x-4 gap-y-2" id="assets-checkbox-group"></div>
                    </div>
                </div>
            </form>
            <button onclick="calculateSES()" id="calculate-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md mt-8">
                ğŸ¯ Calculate Total Score
            </button>
        </div>

        <!-- ======================================= 3. RESULTS SCREEN ======================================= -->
        <div id="results-screen" class="mt-8 hidden">
            <h2 id="results-title" class="text-2xl font-bold text-gray-700 mb-6 text-left-rtl">Calculation Results</h2>
            
            <div id="result-score" class="p-4 sm:p-6 bg-green-50 border border-green-200 rounded-lg mb-4 text-center"></div>
            
            <div id="result-classification" class="p-4 sm:p-6 bg-green-100 border border-green-300 rounded-lg mb-6 text-center"></div>

            <h3 id="breakdown-title" class="text-xl font-bold text-gray-700 mt-6 mb-4 text-left-rtl">Score Breakdown</h3>
            <table class="min-w-full bg-white border border-gray-200 rounded-lg overflow-hidden">
                <thead class="bg-gray-50">
                    <tr>
                        <th id="th-domain" class="py-3 px-4 text-sm font-semibold text-gray-600 border-b text-left-rtl">Domain</th>
                        <th id="th-score" class="py-3 px-4 text-sm font-semibold text-gray-600 border-b text-center">Score</th>
                        <th id="th-max" class="py-3 px-4 text-sm font-semibold text-gray-600 border-b text-center">Max Score</th>
                    </tr>
                </thead>
                <tbody id="breakdown-body" class="divide-y divide-gray-100"></tbody>
            </table>

            <button onclick="startAgain()" id="start-again-button" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md mt-8">
                Start Again
            </button>
        </div>
    </div>

    <script>
        // --- LANGUAGE CONTENT ---
        
        const CITATION_LINK = '<a href="https://doi.org/10.1186/s12889-026-26282-y" target="_blank" class="text-blue-600 hover:underline">https://doi.org/10.1186/s12889-026-26282-y</a>';
        const FULL_CITATION = `El-Gilany, AH., Baklola, M., Terra, M. et al. Refining and validation of Family Socioeconomic Status Scale (FSESS) for health research in Egypt. BMC Public Health (2026). ${CITATION_LINK}`;

        const ARABIC_OVERVIEW_HTML = `
            <h3 class="text-lg font-bold text-gray-800 mb-2">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h3>
            <p>ØªØ¹ØªØ¨Ø± Ø­Ø§Ø³Ø¨Ø© Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ Ù„Ù„Ø£Ø³Ø±Ø© (FSESS) Ø£Ø¯Ø§Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø± Ù…ØµÙ…Ù…Ø© Ù„Ù‚ÙŠØ§Ø³ ÙˆØªØµÙ†ÙŠÙ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ (SES) Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„Ø£Ø¨Ø­Ø§Ø« Ø§Ù„ØµØ­ÙŠØ© ÙˆØ§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© ÙˆØ§Ù„ÙˆØ¨Ø§Ø¦ÙŠØ© ÙÙŠ **Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙˆØ¯ÙˆÙ„ÙŠØ§Ù‹**.</p>
            <p>ØªÙ… ØªØ·ÙˆÙŠØ±Ù‡Ø§ ÙƒØ¬Ø²Ø¡ Ù…Ù† Ø¯Ø±Ø§Ø³Ø©:</p>
            <p class="font-semibold italic">${FULL_CITATION}</p>
            <p>ØªØ³Ù…Ø­ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù„Ø¨Ø§Ø­Ø«ÙŠÙ† ÙˆØ§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ù…Ø§Ø±Ø³ÙŠÙ† Ø¨Ø­Ø³Ø§Ø¨ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ Ø¨Ø³Ø±Ø¹Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ FSESS Ø§Ù„Ø°ÙŠ ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­ØªÙ‡ØŒ ÙˆØ§Ù„Ø°ÙŠ ØªÙ… ØªÙ†Ù‚ÙŠØ­Ù‡ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡ Ø¥Ø­ØµØ§Ø¦ÙŠÙ‹Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø£ÙƒØ«Ø± Ù…Ù† 2,000 Ø£Ø³Ø±Ø© **Ù†Ø§Ø·Ù‚Ø© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©**.</p>
            <p class="text-blue-700 font-bold">Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©: Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØªØ¹Ù…Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„. Ù„Ø§ ÙŠØªÙ… Ø­ÙØ¸ Ø£Ùˆ ØªØ®Ø²ÙŠÙ† Ø£Ùˆ Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¯Ø®Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ø£ÙŠ Ø®Ø§Ø¯Ù….</p>
            
            <h3 class="text-lg font-bold text-gray-800 mt-4 mb-2">Ù…Ø§Ø°Ø§ ØªÙØ¹Ù„ Ø§Ù„Ø£Ø¯Ø§Ø©ØŸ</h3>
            <p>ØªÙ‚ÙˆÙ… Ø­Ø§Ø³Ø¨Ø© FSESS Ø¨Ø£ØªÙ…ØªØ© Ø¹Ù…Ù„ÙŠØ© ØªØ³Ø¬ÙŠÙ„ Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ Ù„Ù„Ø£Ø³Ø±Ø©ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠÙ‚ÙŠÙ… Ø£Ø±Ø¨Ø¹Ø© Ù…Ø¬Ø§Ù„Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ©:</p>
            <ol class="list-decimal list-inside mr-4">
                <li>ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø²ÙˆØ¬ ÙˆÙ…Ù‡Ù†ØªÙ‡</li>
                <li>ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø²ÙˆØ¬Ø© ÙˆÙ…Ù‡Ù†ØªÙ‡Ø§</li>
                <li>Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ø±Ø©</li>
                <li>Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø«Ø±ÙˆØ© ÙˆØ§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª</li>
            </ol>
            <p>Ø¨Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŒ ØªÙ‚ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ© ÙˆØ§Ù„ØªØµÙ†ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
        `;

        const ENGLISH_OVERVIEW_HTML = `
            <h3 class="text-lg font-bold text-gray-800 mb-2">Overview</h3>
            <p>The **Family Socioeconomic Status Scale (FSESS) Calculator** is an **open-access online tool** designed to measure and classify family socioeconomic status (SES) for use in health, social, and epidemiological research across the **Arab world and internationally**.</p>
            <p>It was developed as part of the study:</p>
            <p class="font-semibold italic">${FULL_CITATION}</p>
            <p>This tool allows researchers, students, and practitioners to **quickly compute SES scores** based on the validated FSESS model, which has been statistically refined and validated using data from over 2,000 **Arabic-speaking** families.</p>
            <p class="text-blue-700 font-bold">Privacy Note: This tool runs entirely in your browser. No data entered is saved, stored, or transmitted to any server.</p>

            <h3 class="text-lg font-bold text-gray-800 mt-4 mb-2">What the Tool Does</h3>
            <p>The FSESS calculator automates the scoring process of the Family Socioeconomic Status Scale, which assesses four main domains:</p>
            <ol class="list-decimal list-inside ml-4">
                <li>Husbandâ€™s and Wifeâ€™s Education</li>
                <li>Husbandâ€™s and Wifeâ€™s Occupation</li>
                <li>Family Income</li>
                <li>Overall Wealth Indicators (Assets & Possessions)</li>
            </ol>
            <p>After entering the required information, the calculator automatically computes the scores and classification classes.</p>
        `;

        const LANG_AR = {
            code: 'ar', dir: 'rtl',
            strings: {
                TITLE: 'Ø­Ø§Ø³Ø¨Ø© Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠ Ù„Ù„Ø£Ø³Ø±Ø© (FSESS)',
                WELCOME_TITLE: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø­Ø§Ø³Ø¨Ø© FSESS',
                WELCOME_TEXT_HTML: ARABIC_OVERVIEW_HTML,
                START_CALCULATION: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø³Ø§Ø¨',
                CALCULATION_TITLE: '1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠØ© Ù„Ù„Ø£Ø³Ø±Ø©',
                FINANCE_TITLE: '2. Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆÙ…Ù…ØªÙ„ÙƒØ§Øª Ø§Ù„Ø£Ø³Ø±Ø©',
                HUSBAND_TITLE: 'Ø£. Ø§Ù„Ø²ÙˆØ¬ / Ø±Ø¨ Ø§Ù„Ø£Ø³Ø±Ø©',
                WIFE_TITLE: 'Ø¨. Ø§Ù„Ø²ÙˆØ¬Ø© / Ø±Ø¨Ø© Ø§Ù„Ø£Ø³Ø±Ø©',
                EDU_LABEL: 'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
                OCC_LABEL: 'ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù‡Ù†Ø©',
                INCOME_TITLE: 'Ø¬. Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ø±Ø© (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 Ù†Ù‚Ø§Ø·)',
                ASSETS_TITLE: 'Ø¯. Ù…Ù…ØªÙ„ÙƒØ§Øª Ø§Ù„Ø£Ø³Ø±Ø© (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 Ù†Ù‚Ø§Ø·)',
                CALCULATE_BUTTON: 'ğŸ¯ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©',
                RESULTS_TITLE: 'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø³Ø§Ø¨',
                SCORE_TOTAL: 'Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ© Ù…Ù† ',
                CLASSIFICATION_FINAL: 'Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:',
                SCORE_BREAKDOWN: 'ØªÙØµÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª',
                START_AGAIN: 'Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯',
                ERROR_MISSING: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù‚Ø¨Ù„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨.',
                ERROR_NA_BOTH: "Ø®Ø·Ø£: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± 'Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚' Ù„ÙƒÙ„Ø§ Ø§Ù„Ø²ÙˆØ¬ÙŠÙ†.",
                ERROR_NA_INCONSISTENT: "Ø®Ø·Ø£: Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± 'Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚' Ù„ØªØ¹Ù„ÙŠÙ… Ø£Ùˆ Ù…Ù‡Ù†Ø© Ø£Ø­Ø¯ Ø§Ù„Ø²ÙˆØ¬ÙŠÙ†ØŒ ÙÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø±Ù‡ Ù„Ù„Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¢Ø®Ø± Ù„Ù†ÙØ³ Ø§Ù„Ø²ÙˆØ¬.",
                DOMAIN_EDU: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ… (Ø§Ù„Ø²ÙˆØ¬ ÙˆØ§Ù„Ø²ÙˆØ¬Ø©)',
                DOMAIN_OCC: 'Ø§Ù„Ù…Ù‡Ù†Ø© (Ø§Ù„Ø²ÙˆØ¬ ÙˆØ§Ù„Ø²ÙˆØ¬Ø©)',
                DOMAIN_INC: 'Ø§Ù„Ø¯Ø®Ù„ (Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø±)',
                DOMAIN_ASSET: 'Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª ÙˆØ§Ù„Ø£ØµÙˆÙ„',
                TABLE_DOMAIN: 'Ø§Ù„Ù…Ø¬Ø§Ù„',
                TABLE_SCORE: 'Ø§Ù„Ø¯Ø±Ø¬Ø©',
                TABLE_MAX: 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰',
                CLASSIFICATIONS: { HIGH: 'Ù…Ø±ØªÙØ¹', MIDDLE: 'Ù…ØªÙˆØ³Ø·', LOW: 'Ù…Ù†Ø®ÙØ¶', VERY_LOW: 'Ù…Ù†Ø®ÙØ¶ Ø¬Ø¯Ù‹Ø§' },
                OPTIONS_EDU: [
                    { value: "", label: "-- Ø§Ø®ØªØ± --" },
                    { value: "0", label: "Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚ (Ø§Ù„ÙˆÙØ§Ø© Ø£Ùˆ Ø§Ù„Ø·Ù„Ø§Ù‚)", na: true },
                    { value: "2", label: "Ø£Ù…ÙŠ" }, { value: "4", label: "Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙˆÙŠ" },
                    { value: "6", label: "Ø«Ø§Ù†ÙˆÙŠ" }, { value: "8", label: "Ø¬Ø§Ù…Ø¹ÙŠ" }, { value: "10", label: "Ø¯Ø±Ø§Ø³Ø§Øª Ø¹Ù„ÙŠØ§" }
                ],
                OPTIONS_OCC: [
                    { value: "", label: "-- Ø§Ø®ØªØ± --" },
                    { value: "0", label: "Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚ (Ø§Ù„ÙˆÙØ§Ø© Ø£Ùˆ Ø§Ù„Ø·Ù„Ø§Ù‚)", na: true },
                    { value: "0", label: "Ù„Ø§ ÙŠØ¹Ù…Ù„ â€“ Ø±Ø¨Ø© Ù…Ù†Ø²Ù„" }, { value: "1", label: "Ø¹Ø§Ù…Ù„ ØºÙŠØ± Ù…Ø§Ù‡Ø±" },
                    { value: "2", label: "Ø¹Ø§Ù…Ù„ Ù…Ø§Ù‡Ø±" }, { value: "3", label: "Ø¬Ù†ÙˆØ¯ ÙˆØµÙ Ø¶Ø¨Ø§Ø· Ø§Ù„Ø¬ÙŠØ´ ÙˆØ§Ù„Ø´Ø±Ø·Ø©" },
                    { value: "4", label: "Ø§Ù„Ø¹Ø§Ù…Ù„ÙˆÙ† ÙÙŠ Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø£Ùˆ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­Ø±Ø©" }, { value: "5", label: "Ø§Ù„ÙƒØªØ¨Ø© ÙˆÙ…ÙˆØ¸ÙÙˆ Ø§Ù„Ù…ÙƒØ§ØªØ¨" },
                    { value: "6", label: "Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ù…Ù‡Ù† Ø§Ù„Ø¹Ù„Ù…ÙŠØ© ÙˆØ§Ù„Ù…Ø´Ø±Ø¹ÙˆÙ† ÙˆØ§Ù„Ù…Ø¯ÙŠØ±ÙˆÙ† ÙˆØ¶Ø¨Ø§Ø· Ø§Ù„Ø¬ÙŠØ´ ÙˆØ§Ù„Ø´Ø±Ø·Ø©" }
                ],
                OPTIONS_INCOME: [
                    { value: "0", label: "ÙŠØ³ØªØ¯ÙŠÙ†" }, { value: "1", label: "ÙŠÙƒÙÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø¨Ø§Ù„ÙƒØ§Ø¯" },
                    { value: "2", label: "ÙŠÙƒÙÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØ§Ù„Ø·ÙˆØ§Ø±Ø¦" }, { value: "3", label: "ÙŠØ¯Ø®Ø± ÙˆÙŠØ³ØªØ«Ù…Ø±" }
                ],
                OPTIONS_ASSETS: [
                    { label: "Ø«Ù„Ø§Ø¬Ø©" }, { label: "ØºØ³Ø§Ù„Ø© Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ" }, { label: "Ù‡Ø§ØªÙ Ø°ÙƒÙŠ" }, { label: "Ù…ÙƒÙŠÙ Ù‡ÙˆØ§Ø¡" },
                    { label: "Ø£Ø±Ø¶ Ø²Ø±Ø§Ø¹ÙŠØ©" }, { label: "Ø£Ø±Ø¶ Ù„Ù„Ù…Ø¨Ø§Ù†ÙŠ" }, { label: "Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ / Ù…Ø²Ø±Ø¹Ø© Ù…ÙˆØ§Ø´ÙŠ" },
                    { label: "Ù…Ù†Ø²Ù„ Ø¢Ø®Ø±" }, { label: "Ø³ÙŠØ§Ø±Ø©" }, { label: "ÙƒÙ…Ø¨ÙŠÙˆØªØ±" }
                ]
            }
        };

        const LANG_EN = {
            code: 'en', dir: 'ltr',
            strings: {
                TITLE: 'Family Socioeconomic Status Scale (FSESS) Calculator',
                WELCOME_TITLE: 'Welcome to the FSESS Calculator',
                WELCOME_TEXT_HTML: ENGLISH_OVERVIEW_HTML,
                START_CALCULATION: 'Start Calculation',
                CALCULATION_TITLE: '1. Family Demographics',
                FINANCE_TITLE: '2. Family Finances & Assets',
                HUSBAND_TITLE: 'A. Husband/Male Head of Household',
                WIFE_TITLE: 'B. Wife/Female Head of Household',
                EDU_LABEL: 'Education Level',
                OCC_LABEL: 'Occupation Category',
                INCOME_TITLE: 'C. Family Income (Max 3 points)',
                ASSETS_TITLE: 'D. Family Assets & Possessions (Max 10 points)',
                CALCULATE_BUTTON: 'ğŸ¯ Calculate Total Score',
                RESULTS_TITLE: 'Calculation Results',
                SCORE_TOTAL: 'Total Score out of ',
                CLASSIFICATION_FINAL: 'Final Classification:',
                SCORE_BREAKDOWN: 'Score Breakdown',
                START_AGAIN: 'Start Again',
                ERROR_MISSING: 'Please ensure all required fields are selected before calculating.',
                ERROR_NA_BOTH: "Error: Cannot select 'Non-applicable' for both spouses.",
                ERROR_NA_INCONSISTENT: "Inconsistency Error: If 'Non-applicable' is selected for a spouse's Education or Occupation, it must be selected for both.",
                DOMAIN_EDU: 'Education (Husband & Wife)',
                DOMAIN_OCC: 'Occupation (Husband & Wife)',
                DOMAIN_INC: 'Income (All sources)',
                DOMAIN_ASSET: 'Assets & Possessions',
                TABLE_DOMAIN: 'Domain',
                TABLE_SCORE: 'Score',
                TABLE_MAX: 'Max Score',
                CLASSIFICATIONS: { HIGH: 'High', MIDDLE: 'Middle', LOW: 'Low', VERY_LOW: 'Very Low' },
                OPTIONS_EDU: [
                    { value: "", label: "-- Select --" },
                    { value: "0", label: "Non-applicable (death/divorce)", na: true },
                    { value: "2", label: "Illiterate" }, { value: "4", label: "Less than secondary" },
                    { value: "6", label: "Secondary" }, { value: "8", label: "University" }, { value: "10", label: "Postgraduate" }
                ],
                OPTIONS_OCC: [
                    { value: "", label: "-- Select --" },
                    { value: "0", label: "Non-applicable (death/divorce)", na: true },
                    { value: "0", label: "Non-working / Housewife" }, { value: "1", label: "Unskilled manual worker" },
                    { value: "2", label: "Skilled manual worker" }, { value: "3", label: "Army or police (soldiers & NCOs)" },
                    { value: "4", label: "Business / Trade" }, { value: "5", label: "Clerical / Office worker" },
                    { value: "6", label: "Professional / Legislative / Director / Commissioned officer" }
                ],
                OPTIONS_INCOME: [
                    { value: "0", label: "Indebt" }, { value: "1", label: "Barely meets basic needs" },
                    { value: "2", label: "Meets needs + emergencies" }, { value: "3", label: "Saves and invests" }
                ],
                OPTIONS_ASSETS: [
                    { label: "Refrigerator" }, { label: "Automatic washing machine" }, { label: "Smartphone" }, { label: "Air conditioner" },
                    { label: "Agricultural land" }, { label: "Land for housing" }, { label: "Shop / Animal farm" },
                    { label: "Another house" }, { label: "Car" }, { label: "Computer" }
                ]
            }
        };

        const LANGUAGES = { en: LANG_EN, ar: LANG_AR };
        let CURRENT_LANG = LANGUAGES.en;
        
        // Scoring Constants
        const INITIAL_MAX_SCORE = 45;
        const SPOUSE_MAX_CONTRIB = 16;
        const INCOME_MAX = 3;
        const ASSETS_MAX = 10;
        const EDU_MAX_PER_SPOUSE = 10;
        const OCC_MAX_PER_SPOUSE = 6;

        // --- UI LOGIC ---

        function populateSelect(id, options) {
            const el = document.getElementById(id);
            el.innerHTML = options.map(o => `<option value="${o.value}">${o.label}</option>`).join('');
        }

        function setLanguage(langCode) {
            CURRENT_LANG = LANGUAGES[langCode];
            document.documentElement.lang = CURRENT_LANG.code;
            document.documentElement.dir = CURRENT_LANG.dir;
            document.body.classList.toggle('text-right-rtl', CURRENT_LANG.dir === 'rtl');
            
            const S = CURRENT_LANG.strings;
            document.getElementById('main-title').textContent = S.TITLE;
            document.getElementById('welcome-title').textContent = S.WELCOME_TITLE;
            document.getElementById('welcome-text').innerHTML = S.WELCOME_TEXT_HTML;
            document.getElementById('start-button').textContent = S.START_CALCULATION;
            
            ['edu_h', 'occ_h', 'edu_w', 'occ_w'].forEach(id => populateSelect(id, S[id.startsWith('edu') ? 'OPTIONS_EDU' : 'OPTIONS_OCC']));
            
            document.getElementById('income-radio-group').innerHTML = S.OPTIONS_INCOME.map((o, i) => `
                <div class="flex items-center space-x-3 ${CURRENT_LANG.dir === 'rtl' ? 'space-x-reverse' : ''}">
                    <input id="inc_${i}" name="income" type="radio" value="${o.value}" class="h-4 w-4 text-blue-600 border-gray-300">
                    <label for="inc_${i}" class="text-sm font-medium text-gray-700">${o.label}</label>
                </div>`).join('');

            document.getElementById('assets-checkbox-group').innerHTML = S.OPTIONS_ASSETS.map((o, i) => `
                <div class="flex items-center space-x-3 ${CURRENT_LANG.dir === 'rtl' ? 'space-x-reverse' : ''}">
                    <input id="ast_${i}" name="assets" type="checkbox" value="1" class="h-4 w-4 text-blue-600 rounded border-gray-300">
                    <label for="ast_${i}" class="text-sm font-medium text-gray-700">${o.label}</label>
                </div>`).join('');

            ['calc-title', 'finance-title', 'husband-title', 'wife-title', 'edu-h-label', 'occ-h-label', 'edu-w-label', 'occ-w-label', 'income-title', 'assets-title', 'calculate-button', 'results-title', 'breakdown-title', 'th-domain', 'th-score', 'th-max', 'start-again-button'].forEach(id => {
                const key = id.replace(/-/g, '_').toUpperCase();
                if (S[key]) document.getElementById(id).textContent = S[key];
            });

            document.getElementById('language-select-screen').classList.add('hidden');
            document.getElementById('intro-screen').classList.remove('hidden');
        }

        function startCalculation() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('calculator-screen').classList.remove('hidden');
            document.getElementById('ses-form').reset();
            document.getElementById('error-message').classList.add('hidden');
        }

        function startAgain() {
            document.getElementById('results-screen').classList.add('hidden');
            document.getElementById('intro-screen').classList.remove('hidden');
        }

        function calculateSES() {
            const S = CURRENT_LANG.strings;
            const getVal = id => document.getElementById(id).value;
            const getTxt = id => { const e = document.getElementById(id); return e.options[e.selectedIndex].text; };
            
            const eduH = getVal('edu_h'), eduW = getVal('edu_w'), occH = getVal('occ_h'), occW = getVal('occ_w');
            const incRadio = document.querySelector('input[name="income"]:checked');
            
            if (!eduH || !eduW || !occH || !occW || !incRadio) {
                document.getElementById('error-message').textContent = S.ERROR_MISSING;
                document.getElementById('error-message').classList.remove('hidden');
                return;
            }

            const naLabel = S.OPTIONS_EDU.find(o => o.na).label;
            const hEduNA = getTxt('edu_h').includes(naLabel), hOccNA = getTxt('occ_h').includes(naLabel);
            const wEduNA = getTxt('edu_w').includes(naLabel), wOccNA = getTxt('occ_w').includes(naLabel);

            if (hEduNA !== hOccNA || wEduNA !== wOccNA) {
                document.getElementById('error-message').textContent = S.ERROR_NA_INCONSISTENT;
                document.getElementById('error-message').classList.remove('hidden');
                return;
            }

            if (hEduNA && hOccNA && wEduNA && wOccNA) {
                document.getElementById('error-message').textContent = S.ERROR_NA_BOTH;
                document.getElementById('error-message').classList.remove('hidden');
                return;
            }

            document.getElementById('error-message').classList.add('hidden');

            const scoreEdu = parseInt(eduH) + parseInt(eduW);
            const scoreOcc = parseInt(occH) + parseInt(occW);
            const scoreInc = parseInt(incRadio.value);
            const scoreAst = Array.from(document.querySelectorAll('input[name="assets"]:checked')).length;
            const total = scoreEdu + scoreOcc + scoreInc + scoreAst;

            let max = INITIAL_MAX_SCORE;
            if (hEduNA && hOccNA) max -= SPOUSE_MAX_CONTRIB;
            if (wEduNA && wOccNA) max -= SPOUSE_MAX_CONTRIB;

            const pct = (total / max) * 100;
            let level, color;
            if (pct >= 76) { level = S.CLASSIFICATIONS.HIGH; color = "text-green-800"; }
            else if (pct >= 51) { level = S.CLASSIFICATIONS.MIDDLE; color = "text-blue-800"; }
            else if (pct >= 26) { level = S.CLASSIFICATIONS.LOW; color = "text-yellow-700"; }
            else { level = S.CLASSIFICATIONS.VERY_LOW; color = "text-red-800"; }

            document.getElementById('calculator-screen').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');
            
            document.getElementById('result-score').innerHTML = `<p class="text-base text-green-700">${S.SCORE_TOTAL} ${max}</p><p class="text-4xl font-extrabold ${color}">${total} / ${max}</p>`;
            document.getElementById('result-classification').innerHTML = `<p class="text-xl text-green-800 font-semibold">${S.CLASSIFICATION_FINAL}</p><p class="text-3xl font-bold ${color} mt-1">${level}</p><p class="text-lg text-green-700 mt-1">(${pct.toFixed(1)}%)</p>`;

            const maxEdu = (hEduNA ? 0 : 10) + (wEduNA ? 0 : 10);
            const maxOcc = (hOccNA ? 0 : 6) + (wOccNA ? 0 : 6);

            document.getElementById('breakdown-body').innerHTML = [
                { d: S.DOMAIN_EDU, s: scoreEdu, m: maxEdu },
                { d: S.DOMAIN_OCC, s: scoreOcc, m: maxOcc },
                { d: S.DOMAIN_INC, s: scoreInc, m: INCOME_MAX },
                { d: S.DOMAIN_ASSET, s: scoreAst, m: ASSETS_MAX }
            ].map(i => `<tr class="hover:bg-gray-50"><td class="py-3 px-4 text-gray-800 text-left-rtl">${i.d}</td><td class="py-3 px-4 text-gray-800 text-center font-medium">${i.s}</td><td class="py-3 px-4 text-gray-600 text-center">${i.m}</td></tr>`).join('');
        }
    </script>
</body>
</html>
